name: CICDTest 單元測試 (.NET 10 on Windows)

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:
  test:

    runs-on: windows-latest

    steps:
    # 1. 取得原始碼
    - name: 取得原始碼
      uses: actions/checkout@v4

    # 2. 安裝 .NET 10
    - name: 安裝 .NET 10
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: 10.0.x

    # 3. 快取 NuGet 套件，加速 restore
    - name: 快取 NuGet 套件
      uses: actions/cache@v3
      with:
        path: ~/.nuget/packages
        key: nuget-${{ runner.os }}-${{ hashFiles('CICDTest/**/*.csproj') }}

    # 4. 還原解決方案
    - name: 還原解決方案套件
      run: dotnet restore CICDTest.sln

    # 5. 建置解決方案
    - name: 建置解決方案
      run: dotnet build CICDTest.sln --no-restore --configuration Release

    # 6. 執行單元測試
    - name: 執行單元測試
      run: dotnet test CICDTest.sln --no-build --verbosity normal
